function AutoSuggestControl(id_or_element){this.provider=new wordSuggestions();this.textbox=typeof id_or_element=="string"?document.getElementById(id_or_element):id_or_element;this.init()}AutoSuggestControl.prototype.autosuggest=function(aSuggestions){if(aSuggestions.length>0){this.typeAhead(aSuggestions[0])}};AutoSuggestControl.prototype.handleKeyUp=function(oEvent){var iKeyCode=oEvent.keyCode;var evtobj=oEvent;window.eventobj=evtobj;if((iKeyCode!=16&&iKeyCode<32)||(iKeyCode>=33&&iKeyCode<=46)||(iKeyCode>=112&&iKeyCode<=123)||(iKeyCode==65&&evtobj.ctrlKey)||(iKeyCode==90&&evtobj.ctrlKey)){if(iKeyCode==90&&evtobj.ctrlKey){}}else{this.provider.requestSuggestions(this)}};AutoSuggestControl.prototype.init=function(){var oThis=this;lastDate=new Date();oThis.textbox.onkeyup=function(oEvent){if(!oEvent){oEvent=window.event}newDate=new Date();if(newDate.getTime()>lastDate.getTime()+200){oThis.handleKeyUp(oEvent);lastDate=newDate}}};AutoSuggestControl.prototype.selectRange=function(iStart,iLength){if(this.textbox.createTextRange){var oRange=this.textbox.createTextRange();oRange.moveStart("character",iStart);oRange.moveEnd("character",iLength);oRange.select()}else{if(this.textbox.setSelectionRange){this.textbox.setSelectionRange(iStart,iLength)}}this.textbox.focus()};AutoSuggestControl.prototype.typeAhead=function(sSuggestion){if(this.textbox.createTextRange||this.textbox.setSelectionRange){var lastSpace=this.textbox.value.lastIndexOf(" ");var lastQuote=this.textbox.value.lastIndexOf("'");var lastHypen=this.textbox.value.lastIndexOf("-");var lastDoubleQuote=this.textbox.value.lastIndexOf('"');var lastEnter=this.textbox.value.lastIndexOf("\n");var lastIndex=Math.max(lastSpace,lastEnter,lastQuote,lastHypen,lastDoubleQuote)+1;var contentStripped=this.textbox.value.substring(0,lastIndex);var lastWord=this.textbox.value.substring(lastIndex,this.textbox.value.length);this.textbox.value=contentStripped+sSuggestion;var start=this.textbox.value.length-sSuggestion.replace(lastWord,"").length;var end=this.textbox.value.length;this.selectRange(start,end)}};wordSuggestions.prototype.requestSuggestions=function(oAutoSuggestControl){var aSuggestions=[];var sTextbox=oAutoSuggestControl.textbox.value;var sTextboxSplit=sTextbox.split(/[\s,]+/);var sTextboxLast=sTextboxSplit[sTextboxSplit.length-1];var sTextboxValue=sTextboxLast;if(sTextboxValue.length>0){for(var i=0;i<this.words.length;i++){if(this.words[i].indexOf(sTextboxValue)==0){if(this.words[i].indexOf(sTextboxValue)==0){aSuggestions.push(this.words[i])}else{if(this.words[i].indexOf(sTextboxValue.charAt(0)+sTextboxValue.slice(1))==0){aSuggestions.push(this.words[i].charAt(0)+this.words[i].slice(1))}}}}}oAutoSuggestControl.autosuggest(aSuggestions)};function wordSuggestions(){var wordList=["{InputFile}","{LastOutput}","{Job}","{ThreadN}","{Output:","{LastOutput:","{Uploaded:","{Suffix:","{Workspace}","{History:","{UserBin}","{JobName}"];$.ajax({type:"GET",url:"/ui/user-reference",dataType:"json",success:function(data){wordList=wordList.concat(data.split(","))},async:false,});this.words=wordList};